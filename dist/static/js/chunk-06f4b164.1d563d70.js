(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06f4b164"],{"0a4d":function(t,a,e){"use strict";e("8134")},"640c":function(t,a,e){"use strict";e.d(a,"c",(function(){return s})),e.d(a,"a",(function(){return n})),e.d(a,"d",(function(){return o})),e.d(a,"b",(function(){return l}));e("4360");var i=e("751a");function s(){return Object(i["a"])({url:"/info_screen/profitAndLossModel/getAllMachineType",method:"post"})}function n(t){return Object(i["a"])({url:"/info_screen/profitAndLossModel/addMachineType",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/info_screen/profitAndLossModel/updateMachineType",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/info_screen/profitAndLossModel/deleteMachineType",method:"DELETE",data:t})}},8134:function(t,a,e){},"9a21c":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"profit-container"},[e("h3",[t._v(t._s(t.$t("finance.profit.title")))]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{xl:7,lg:7,md:7}},[e("el-table",{attrs:{data:t.costTableData,"header-cell-style":{background:"#eef1f6",color:"#606266",textAlign:"center"},stripe:"",border:!0,"span-method":t.arraySpan,"cell-class-name":t.cellClassName}},[e("el-table-column",{attrs:{label:t.$t("finance.profit.costEstimation")}},[e("el-table-column",{attrs:{prop:"cost",label:t.$t("finance.profit.revenue")}}),e("el-table-column",{attrs:{prop:"value",label:t.$t("finance.profit.attribute")}}),e("el-table-column",{attrs:{prop:"sum",align:"right",label:t.$t("finance.profit.amount")}}),e("el-table-column",{attrs:{prop:"proportion",align:"right",label:t.$t("finance.profit.occupancy")}})],1)],1)],1),e("el-col",{staticClass:"mr",attrs:{xl:4,lg:5,md:6}},[e("el-table",{attrs:{data:t.totalTableData,"header-cell-style":{background:"rgb(238, 241, 246)",color:"#606266",textAlign:"center"},stripe:"",border:!0,"cell-class-name":t.totalCellName}},[e("el-table-column",{attrs:{prop:"cost",label:t.$t("finance.profit.conclusion")}}),e("el-table-column",{attrs:{prop:"sum",width:"150",align:"right",label:t.$t("finance.profit.data")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.sum>=1e3||a.row.sum<=-1e3?e("span",[t._v(t._s(t._f("fmtNum")(a.row.sum)))]):e("span",[t._v(t._s(a.row.sum))])]}}])})],1),e("el-table",{attrs:{data:t.chartTableData,"header-cell-style":{color:"#606266"},stripe:"",border:!0,"cell-class-name":t.cellClassName}},[e("el-table-column",{attrs:{label:t.$t("finance.profit.chartAuxiliaryColumn")}},[e("el-table-column",{attrs:{prop:"category",label:t.$t("finance.profit.type")}}),e("el-table-column",{attrs:{prop:"min",align:"right",label:t.$t("finance.profit.min")},scopedSlots:t._u([{key:"default",fn:function(a){return[0==a.$index||1==a.$index||2==a.$index?e("el-input",{staticClass:"input-style",model:{value:a.row.min,callback:function(e){t.$set(a.row,"min",e)},expression:"scope.row.min"}}):e("span",[t._v(t._s(a.row.min))])]}}])}),e("el-table-column",{attrs:{prop:"max",align:"right",label:t.$t("finance.profit.max")}})],1)],1)],1),e("el-col",{attrs:{xl:13,lg:12,md:11}},[e("el-row",{attrs:{gutter:20}},t._l(t.saleInfo,(function(a,i){return e("el-col",{key:a,staticClass:"saleInfo",attrs:{span:8}},[e("el-card",[e("div",{staticClass:"saleInfo-title"},[t._v(" "+t._s(a.title)+" ")]),e("div",{staticClass:"saleInfo-num"},[0==i?e("el-input",{on:{input:function(a){return t.getNum(t.sum)}},model:{value:t.sum,callback:function(a){t.sum=a},expression:"sum"}}):t._e(),1==i?e("el-input",{on:{input:function(a){return t.handleCount(t.saleNum)}},model:{value:t.saleNum,callback:function(a){t.saleNum=a},expression:"saleNum"}}):t._e(),2==i?e("el-select",{on:{change:t.changeMachineData},model:{value:t.machine,callback:function(a){t.machine=a},expression:"machine"}},t._l(t.machineOption,(function(t){return e("el-option",{key:t.machineName,attrs:{label:t.machineName,value:t.id}})})),1):t._e()],1)])],1)})),1),e("div",{staticClass:"chart-container"},[e("div",{staticClass:"line",attrs:{id:"line"}})])],1)],1)],1)},s=[],n=(e("13d5"),e("640c")),o={name:"profit-index",data(){return{sum:"600",saleNum:"1500",machineOption:[],machine:null}},filters:{fmtNum(t){return t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}},computed:{saleInfo(){return[{title:this.$t("finance.profit.salesPrice"),sum:""},{title:this.$t("finance.profit.salesNum"),saleSum:""},{title:this.$t("finance.profit.modelSelection"),machine:""}]},costTableData(){return[{cost:this.$t("finance.profit.ariableCost"),value:"",sum:"",proportion:"",name:"ariableCost"},{cost:this.$t("finance.profit.bomCost"),value:this.$t("finance.profit.variablePriceRatio"),sum:"",proportion:"",name:"bomCost"},{cost:this.$t("finance.profit.promotionExpense"),value:this.$t("finance.profit.fixedPriceRatio"),sum:"",proportion:"",name:"promotionExpense"},{cost:this.$t("finance.profit.brandExpense"),value:this.$t("finance.profit.fixedPriceRatio"),sum:"",proportion:"",name:"brandExpense"},{cost:this.$t("finance.profit.freight"),value:this.$t("finance.profit.fixedFee"),sum:"",proportion:"",name:"freight"},{cost:this.$t("finance.profit.wastage"),value:this.$t("finance.profit.fixedFee"),sum:"",proportion:"",name:"wastage"},{cost:this.$t("finance.profit.websitePlatformCost"),value:this.$t("finance.profit.fixedPriceRatio"),sum:"",proportion:"",name:"websitePlatformCost"},{cost:this.$t("finance.profit.packingExpense"),value:this.$t("finance.profit.fixedPriceRatio"),sum:"",proportion:"",name:"packingExpense"},{cost:this.$t("finance.profit.taxes"),value:this.$t("finance.profit.fixedPriceRatio"),sum:"",proportion:"",name:"taxes"},{cost:this.$t("finance.profit.salesCommission"),value:this.$t("finance.profit.fixedPriceRatio"),sum:"",proportion:"",name:"salesCommission"},{cost:this.$t("finance.profit.other"),value:this.$t("finance.profit.fixedPriceRatio"),sum:"",proportion:"",name:"other"},{cost:this.$t("finance.profit.unitContributionMargin"),value:"",sum:"",proportion:"",name:"unitContributionMargin"},{cost:this.$t("finance.profit.totalFixedCost"),value:"",sum:"",proportion:"",name:"totalFixedCost"},{cost:this.$t("finance.profit.developmentExpense"),value:this.$t("finance.profit.fixedFee"),sum:"",proportion:"",name:"developmentExpense"},{cost:this.$t("finance.profit.sellingExpense"),value:this.$t("finance.profit.fixedFee"),sum:"",proportion:"",name:"sellingExpense"},{cost:this.$t("finance.profit.managerExpense"),value:this.$t("finance.profit.fixedFee"),sum:"",proportion:"",name:"managerExpense"},{cost:this.$t("finance.profit.otherExpense"),value:this.$t("finance.profit.fixedFee"),sum:"",proportion:"",name:"otherExpense"}]},totalTableData(){return[{cost:this.$t("finance.profit.totalSalesRevenue"),sum:""},{cost:this.$t("finance.profit.totalCost"),sum:""},{cost:this.$t("finance.profit.totalMarginalContribution"),sum:""},{cost:this.$t("finance.profit.profitMargin"),sum:""},{cost:this.$t("finance.profit.breakevenSalesVolume"),sum:""}]},chartTableData(){return[{category:this.$t("finance.profit.salesVolume"),min:"0",max:""},{category:this.$t("finance.profit.totalRevenue"),min:"0",max:""},{category:this.$t("finance.profit.variableCosts"),min:"0",max:""},{category:this.$t("finance.profit.totalCost"),min:"",max:""},{category:this.$t("finance.profit.fixedCost"),min:"",max:""}]}},watch:{"$i18n.locale":{handler(){this.getMachine()},immediate:!0}},methods:{init(){this.setIncome(),this.getNum(),this.handleCount()},setIncome(){let t=[11,12,13,14,15,16];this.costTableData[0].sum=this.costTableData.reduce((a,e,i)=>t.includes(i)?a:Number(e.sum)+a,0),this.costTableData[12].sum=this.costTableData.reduce((a,e,i)=>11!==t&&12!==t&&t.includes(i)?Number(e.sum)+a:a,0)},getNum(t){t=t||this.sum,t&&(this.sum=t,this.setData())},setData(){let t=[11,12,13,14,15,16,17];this.costTableData[11].sum=this.getFixNum(this.sum-this.costTableData[0].sum),this.costTableData.forEach((a,e)=>{t.includes(e)||(this.costTableData[e].proportion=this.getRoundNum(a.sum/this.sum))}),this.costTableData[11].proportion=this.getRoundNum(this.costTableData[11].sum/this.sum),this.setCountData()},handleCount(t){t&&(console.log(t,"数目"),this.saleNum=t,this.setCountData())},setCountData(){this.totalTableData[0].sum=this.getFixNum(this.sum*this.saleNum),this.totalTableData[1].sum=this.getFixNum(this.costTableData[0].sum*this.saleNum+this.costTableData[12].sum),this.totalTableData[2].sum=this.getFixNum(this.saleNum*this.costTableData[11].sum),this.totalTableData[3].sum=this.getRoundNum((this.totalTableData[0].sum-this.totalTableData[1].sum)/this.totalTableData[0].sum),this.totalTableData[4].sum=Math.round(this.costTableData[12].sum/this.costTableData[11].sum,0),this.totalTableData[0].sum&&(this.costTableData[12].proportion=this.getRoundNum(this.costTableData[12].sum/this.totalTableData[0].sum),this.costTableData[13].proportion=this.getRoundNum(this.costTableData[13].sum/this.totalTableData[0].sum),this.costTableData[14].proportion=this.getRoundNum(this.costTableData[14].sum/this.totalTableData[0].sum),this.costTableData[15].proportion=this.getRoundNum(this.costTableData[15].sum/this.totalTableData[0].sum),this.costTableData[16].proportion=this.getRoundNum(this.costTableData[16].sum/this.totalTableData[0].sum)),this.setChartTable()},setChartTable(){this.chartTableData[0].max=this.saleNum,this.chartTableData[1].max=this.totalTableData[0].sum,this.chartTableData[2].max=this.getFixNum(this.costTableData[0].sum*this.chartTableData[0].max),this.chartTableData[4].max=this.chartTableData[4].min=this.costTableData[12].sum,this.chartTableData[3].min=Number(this.chartTableData[2].min)+this.chartTableData[4].min,this.chartTableData[3].max=this.getFixNum(Number(this.chartTableData[2].max)+this.chartTableData[4].max),this.setChart()},getRoundNum(t){return Math.round(100*t.toFixed(2))+"%"},getFixNum(t){return Number.isInteger(t)?t:Number(t).toFixed(2)},arraySpan({rowIndex:t,columnIndex:a}){return 11===t&&0===a||12===t&&0===a?[1,2]:11===t&&1===a||12===t&&1===a?[0,0]:void 0},cellClassName({rowIndex:t,columnIndex:a}){return 11!==t&&12!==t||0!==a?t%2===0?"":"table-row-striped":"cell-center"},totalCellName({rowIndex:t,columnIndex:a}){return 4===t&&1===a?"red":t%2===0?"":"table-row-striped"},saleCellName({rowIndex:t,columnIndex:a}){if(0===t&&1===a)return"yellow"},setChart(){const t=[this.chartTableData[1].min,this.chartTableData[1].max],a=[this.chartTableData[2].min,this.chartTableData[2].max],e=[this.chartTableData[3].min,this.chartTableData[3].max],i=[this.chartTableData[4].min,this.chartTableData[4].max];Number(this.saleNum),this.saleNum.slice(1);let s=[this.chartTableData[0].min,this.chartTableData[0].max],n={tooltip:{show:!0,trigger:"item"},legend:{data:["总收入","变动成本","总成本","固定成本"]},xAxis:{type:"category",min:this.chartTableData[0].min,max:this.saleNum,data:s,boundaryGap:!1,axisPointer:{show:!0},axisLine:{show:!0},splitNumber:5,axisTick:{alignWithLabel:!0,interval:"auto"},axisLabel:{show:!0,interval:"auto"}},yAxis:{type:"value",axisLine:{show:!0}},grid:{containLabel:!0,left:"3%",right:"3%",bottom:"3%"},series:[{data:t,type:"line",name:"总收入"},{data:a,type:"line",name:"变动成本"},{data:e,type:"line",name:"总成本"},{data:i,type:"line",name:"固定成本"}]},o=this.$echarts.init(document.getElementById("line"));o.setOption(n)},async getMachine(){const{data:t}=await Object(n["c"])();200==t.code&&(this.machineOption=t.data,this.machine=this.machineOption[0].id,this.changeMachineData(this.machineOption[0].id))},async changeMachineData(t){if(t){const a=this.machineOption.filter(a=>a.id==t)[0];this.costTableData.map(t=>{a[t.name]?t.sum=a[t.name]:t.sum=""}),this.init()}}},created(){document.title="Profit Dashboard"},async mounted(){await this.getMachine()}},l=o,r=(e("0a4d"),e("2877")),c=Object(r["a"])(l,i,s,!1,null,null,null);a["default"]=c.exports}}]);
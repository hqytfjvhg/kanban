(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e258ac2e"],{"3f39":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"setting-container"},[s("div",{staticClass:"setting-box",staticStyle:{margin:"20px auto",height:"650px",width:"97%",background:"#fff"}},[s("el-tabs",{staticStyle:{padding:"30px 20px",height:"90%"},attrs:{"tab-position":"left"}},[s("el-tab-pane",{attrs:{label:t.$t("my.baseSetting")}},[s("div",{staticClass:"base",staticStyle:{margin:"20px"}},[s("div",{staticClass:"title",staticStyle:{"font-size":"30px"}},[t._v(" "+t._s(t.$t("my.baseSetting"))+" ")]),s("div",{staticClass:"content",staticStyle:{display:"flex","justify-content":"space-around",margin:"30px 20px"}},[s("div",{staticClass:"form"},[s("el-form",{attrs:{"label-position":"right","label-width":"100px",model:t.userForm}},[s("el-form-item",{attrs:{label:t.$t("my.username")}},[s("el-input",{staticStyle:{width:"800px"},model:{value:t.userForm.username,callback:function(e){t.$set(t.userForm,"username",e)},expression:"userForm.username"}})],1),s("el-form-item",{attrs:{label:t.$t("my.phone")}},[s("el-input",{staticStyle:{width:"800px"},model:{value:t.userForm.phone,callback:function(e){t.$set(t.userForm,"phone",e)},expression:"userForm.phone"}})],1),s("el-form-item",[s("el-button",{staticStyle:{"margin-left":"100px"},attrs:{type:"primary"},on:{click:t.confirm}},[t._v(t._s(t.$t("my.save")))])],1)],1)],1),s("div",{staticClass:"avatar-upload",staticStyle:{border:"1px dashed #dedede",margin:"auto","border-radius":"50%"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.base_api+"/info_screen/user/avatar/upload","show-file-list":!1,"on-success":t.handleAvatarSuccess}},[t.userForm.avatar?s("img",{staticClass:"avatar",staticStyle:{"border-radius":"50%"},attrs:{src:t.base_api+t.userForm.avatar}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon",staticStyle:{"font-size":"50px",padding:"50px"}})])],1)])])]),s("el-tab-pane",{attrs:{label:t.$t("my.safeSetting")}},[s("div",{staticClass:"safe",staticStyle:{margin:"20px"}},[s("div",{staticClass:"title",staticStyle:{"font-size":"30px"}},[t._v(" "+t._s(t.$t("my.safeSetting"))+" ")]),s("div",{staticClass:"safe-content",staticStyle:{margin:"30px 20px"}},[s("div",{staticClass:"list",staticStyle:{display:"flex","justify-content":"space-between","border-bottom":"1px solid #dedede",padding:"10px"}},[s("div",{staticClass:"list-item"},[s("div",{staticClass:"title",staticStyle:{padding:"5px","font-size":"20px"}},[t._v(" "+t._s(t.$t("my.password"))+" ")]),s("div",{staticClass:"describe",staticStyle:{padding:"5px","font-size":"15px",color:"#409eff"}},[t._v(" "+t._s(t.$t("my.passwordStrength"))+"strong ")])]),s("el-button",{staticClass:"update",staticStyle:{margin:"auto 10px"},attrs:{type:"text"},on:{click:function(e){t.updateBaseInfo(t.$t("my.editPassword"))}}},[t._v(t._s(t.$t("my.update")))])],1),s("div",{staticClass:"list",staticStyle:{display:"flex","justify-content":"space-between","border-bottom":"1px solid #dedede",padding:"10px"}},[s("div",{staticClass:"list-item"},[s("div",{staticClass:"title",staticStyle:{padding:"5px","font-size":"20px"}},[t._v(" "+t._s(t.$t("my.phone"))+" ")]),s("div",{staticClass:"describe",staticStyle:{padding:"5px","font-size":"15px",color:"#409eff"}},[t._v(" "+t._s(t.$t("my.phoneBound"))+":"+t._s(t.user.phone)+" ")])]),s("el-button",{staticClass:"update",staticStyle:{margin:"auto 10px"},attrs:{type:"text"},on:{click:function(e){t.updateBaseInfo(t.$t("my.editPhone"))}}},[t._v(t._s(t.$t("my.update")))])],1),s("div",{staticClass:"list",staticStyle:{display:"flex","justify-content":"space-between","border-bottom":"1px solid #dedede",padding:"10px"}},[s("div",{staticClass:"list-item"},[s("div",{staticClass:"title",staticStyle:{padding:"5px","font-size":"20px"}},[t._v(" "+t._s(t.$t("my.email"))+" ")]),s("div",{staticClass:"describe",staticStyle:{padding:"5px","font-size":"15px",color:"#409eff"}},[t._v(" "+t._s(null===t.user.email?this.$t("my.unbinding"):t.user.email)+" ")])]),s("el-button",{staticClass:"update",staticStyle:{margin:"auto 10px"},attrs:{type:"text"},on:{click:function(e){t.updateBaseInfo(t.$t("my.bindEmail"))}}},[t._v(t._s(t.$t("my.bound")))])],1)])])])],1)],1),s("el-dialog",{attrs:{title:t.editTitle,visible:t.editShow,width:"30%","destroy-on-close":!0},on:{"update:visible":function(e){t.editShow=e}}},[t.editTitle==t.$t("my.editPassword")?s("div",[s("el-form",{ref:"editForm",attrs:{model:t.editForm,rules:t.rules,size:"mini"}},[s("el-form-item",{attrs:{label:t.$t("my.originalPassword"),prop:"oldPass"}},[s("el-input",{model:{value:t.editForm.oldPass,callback:function(e){t.$set(t.editForm,"oldPass",e)},expression:"editForm.oldPass"}})],1),s("el-form-item",{attrs:{label:t.$t("my.newPassword"),prop:"newPass"}},[s("el-input",{model:{value:t.editForm.newPass,callback:function(e){t.$set(t.editForm,"newPass",e)},expression:"editForm.newPass"}})],1),s("el-form-item",{attrs:{label:t.$t("my.duplicatePassword"),prop:"confirmPass"}},[s("el-input",{model:{value:t.editForm.confirmPass,callback:function(e){t.$set(t.editForm,"confirmPass",e)},expression:"editForm.confirmPass"}})],1)],1),s("div",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"flex-end"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.editShow=!1}}},[t._v(t._s(t.$t("my.cancel")))]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("editForm")}}},[t._v(t._s(t.$t("my.submit")))])],1)],1):t._e(),t.editTitle==t.$t("my.editPhone")?s("div",[s("el-form",{ref:"editForm",attrs:{model:t.editForm,rules:t.rules,size:"mini"}},[s("el-form-item",{attrs:{label:t.$t("my.phoneInfo"),prop:"phone"}},[s("el-input",{model:{value:t.editForm.phone,callback:function(e){t.$set(t.editForm,"phone",e)},expression:"editForm.phone"}})],1)],1),s("div",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"flex-end"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.editShow=!1}}},[t._v(t._s(t.$t("my.cancel")))]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitFormPhone("editForm")}}},[t._v(t._s(t.$t("my.submit")))])],1)],1):t._e(),t.editTitle==t.$t("my.bindEmail")?s("div",[s("el-form",{ref:"editForm",attrs:{model:t.editForm,rules:t.rules,size:"mini"}},[s("el-form-item",{attrs:{label:t.$t("my.emailInfo"),prop:"email"}},[s("el-input",{model:{value:t.editForm.email,callback:function(e){t.$set(t.editForm,"email",e)},expression:"editForm.email"}})],1),s("el-form-item",{attrs:{label:t.$t("my.VerificationCodeInfo"),prop:"VerificationCode"}},[s("el-input",{model:{value:t.editForm.VerificationCode,callback:function(e){t.$set(t.editForm,"VerificationCode",e)},expression:"editForm.VerificationCode"}})],1)],1),s("div",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"flex-end"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.editShow=!1}}},[t._v(t._s(t.$t("my.cancel")))]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitFormEmail("editForm")}}},[t._v(t._s(t.$t("my.submit")))])],1)],1):t._e()])],1)},a=[],o=(s("d9e2"),s("14d9"),s("c24f")),r={components:{},name:"userSetting",data(){return{base_api:"https://api.board.ifi-cloud.com",userForm:{username:"",phone:"",avatar:""},user:{},editShow:!1,editTitle:"",editForm:{oldPass:"",phone:"",email:"",newPass:"",confirmPass:"",VerificationCode:""}}},computed:{rules(){var t=(t,e,s)=>{""===e?s(new Error("请再次输入密码")):e!==this.editForm.newPass?s(new Error(this.$t("my.comfirmPassInfo"))):s()};return{oldPass:[{required:!0,message:this.$t("my.oldPassInfo"),trigger:"blur"}],phone:[{required:!0,message:this.$t("my.phoneInfo"),trigger:"blur"}],email:[{required:!0,message:this.$t("my.emailInfo"),trigger:"blur"}],VerificationCode:[{required:!0,message:this.$t("my.VerificationCodeInfo"),trigger:"blur"}],newPass:[{required:!0,message:this.$t("my.newPassInfo"),trigger:"blur"}],confirmPass:[{required:!0,message:this.$t("my.comfirmPassInfo"),trigger:"blur"},{validator:t,trigger:"blur"}]}}},watch:{},methods:{submitForm(t){this.$refs[t].validate(t=>{if(!t)return console.log("error submit!!"),!1;{this.editShow=!1;const{data:t}=Object(o["i"])(this.editForm);this.$message({type:200==t.code?"success":"error",message:t.msg}),200==t.code&&(localStorage.removeItem("token"),this.$store.commit("SET_TOKEN",""))}})},submitFormPhone(t){this.$refs[t].validate(t=>{if(!t)return!1})},submitFormEmail(t){this.$refs[t].validate(t=>{if(!t)return!1;{const{data:t}=bindEmail(this.editForm.email,this.editForm.VerificationCode);200==t.code?(this.$message({type:"success",message:this.editForm.email+"绑定成功"}),this.email="",this.code="",this.success=!1):this.$message({type:"error",message:this.editForm.email+"绑定失败"})}})},updateBaseInfo(t){for(let e in this.editForm)this.editForm[e]="";this.editShow=!0,this.editTitle=t,"password"==t&&(this.editTitle="修改密码"),"phone"==t&&(this.editTitle="修改电话")},handleAvatarSuccess(t){200==t.code&&(this.userForm.avatar="\\"+t.data)},async confirm(){console.log(this.userForm);const{data:t}=await Object(o["h"])(this.userForm);console.log(t),200==t.code&&(""!=this.userForm.username&&(localStorage.setItem("username",this.userForm.username),this.$store.commit("SET_USERNAME",this.userForm.username),localStorage.removeItem("token"),this.$store.commit("SET_TOKEN","")),""!=this.userForm.avatar&&(localStorage.setItem("avatar",this.userForm.avatar),this.$store.commit("SET_AVATAR",this.userForm.avatar)),this.$message({type:"success",message:"设置基本个人信息成功"}),this.$router.go(0))},toPath(t){this.$router.push(t)},async getUserInfo(){const{data:t}=await Object(o["b"])();200==t.code&&(this.user=t.data)}},created(){},mounted(){this.getUserInfo()},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){}},l=r,n=(s("7b53"),s("2877")),d=Object(n["a"])(l,i,a,!1,null,"61e791c3",null);e["default"]=d.exports},"7b53":function(t,e,s){"use strict";s("e5d6")},e5d6:function(t,e,s){}}]);
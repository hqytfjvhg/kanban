(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28dcd49c"],{"014c":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"sale-container",staticStyle:{"padding-bottom":"50px"},attrs:{id:"sale"}},[i("div",{staticClass:"new-create"},[i("el-button",{staticClass:"create-button",attrs:{type:"success",size:"mini"},on:{click:function(t){return e.openDialog(1)}}},[e._v("新增")]),i("el-upload",{attrs:{action:e.base_api+"/info_screen/sale/excel/handler",multiple:"",limit:1,"on-success":e.handleSuccess,headers:e.headers}},[i("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("批量新增 (excel)")])],1)],1),i("div",{staticClass:"table"},[i("el-table",{staticClass:"table-content",staticStyle:{width:"100%"},attrs:{data:e.sales,border:!0,stripe:""}},[i("el-table-column",{attrs:{prop:"saleId",label:"ID",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"product",label:"product",width:"200",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("FilterHeader",{attrs:{column:t.column,"field-name":"product","filter-type":"text"},on:{tableFilter:e.tableFilter,resetFilter:e.tableFilterReset}})]}},{key:"default",fn:function(t){return[t.row.saleId==e.currentUpdateId?i("el-input",{model:{value:e.updateForm.product,callback:function(t){e.$set(e.updateForm,"product",t)},expression:"updateForm.product"}}):i("span",[e._v(e._s(t.row.product))])]}}])}),i("el-table-column",{attrs:{prop:"saleIfi",label:"saleIfi",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.saleId==e.currentUpdateId?i("el-input",{model:{value:e.updateForm.saleIfi,callback:function(t){e.$set(e.updateForm,"saleIfi",t)},expression:"updateForm.saleIfi"}}):i("span",[e._v(e._s(t.row.saleIfi))])]}}])}),i("el-table-column",{attrs:{prop:"saleDistrib",label:"saleDistrib",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.saleId==e.currentUpdateId?i("el-input",{model:{value:e.updateForm.saleDistrib,callback:function(t){e.$set(e.updateForm,"saleDistrib",t)},expression:"updateForm.saleDistrib"}}):i("span",[e._v(e._s(t.row.saleDistrib))])]}}])}),i("el-table-column",{attrs:{prop:"total",label:"total",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.saleId==e.currentUpdateId?i("el-input",{model:{value:e.updateForm.total,callback:function(t){e.$set(e.updateForm,"total",t)},expression:"updateForm.total"}}):i("span",[e._v(e._s(t.row.total))])]}}])}),i("el-table-column",{attrs:{label:"operation",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.saleId==e.currentUpdateId?i("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[i("div",[i("el-button",{attrs:{type:"success",round:"",size:"mini"},on:{click:e.confirmUpdate}},[e._v("confirm")])],1),i("div",[i("el-button",{attrs:{type:"warning",round:"",size:"mini"},on:{click:e.cancelUpdate}},[e._v("cancel")])],1)]):i("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[i("div",[i("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(i){return e.update(t.row)}}},[e._v("update")])],1),i("div",[i("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(i){return e.deleteSale(t.row.saleId)}}},[e._v("delete")])],1)])]}}])})],1),i("div",{staticClass:"block",staticStyle:{margin:"20px auto"}},[i("el-pagination",{staticStyle:{float:"right","margin-bottom":"20px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.page.pageNum,total:e.page.total,"page-size":e.page.pageSize},on:{"update:currentPage":function(t){return e.$set(e.page,"pageNum",t)},"update:current-page":function(t){return e.$set(e.page,"pageNum",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e.tableVisable?i("div",{staticClass:"table"},[i("el-card",{staticClass:"table-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("excel data")]),i("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"primary"},on:{click:e.submitToBatch}},[e._v("确认批量操作")])],1),i("el-table",{staticClass:"table-content",staticStyle:{width:"60%",margin:"0 auto"},attrs:{data:e.excelData,border:"true"}},[i("el-table-column",{attrs:{prop:"product",label:"product",width:"200",align:"center"}}),i("el-table-column",{attrs:{prop:"saleIfi",label:"ifi",width:"200",align:"center"}}),i("el-table-column",{attrs:{prop:"saleDistrib",label:"distrib",width:"200",align:"center"}}),i("el-table-column",{attrs:{prop:"total",label:"total",align:"center"}})],1)],1)],1):e._e(),i("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.visible,width:"35%"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[i("el-form",{attrs:{model:e.form,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"product:"}},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}})],1),i("el-form-item",{attrs:{label:"saleIfi:"}},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.form.saleIfi,callback:function(t){e.$set(e.form,"saleIfi",t)},expression:"form.saleIfi"}})],1),i("el-form-item",{attrs:{label:"saleDistrib:"}},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.form.saleDistrib,callback:function(t){e.$set(e.form,"saleDistrib",t)},expression:"form.saleDistrib"}})],1),i("el-form-item",{attrs:{label:"total:"}},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.form.total,callback:function(t){e.$set(e.form,"total",t)},expression:"form.total"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("confirm")])],1)],1)],1)],1)},s=[],o=(i("14d9"),i("c4c3")),n=i("4360"),l=i("d2c2"),r={name:"data-sale",data(){return{base_api:"https://api.board.ifi-cloud.com",sales:[],conditionsFields:[],updateForm:{},currentUpdateId:0,form:{},tableVisable:!1,excelData:[],products:[],headers:{token:n["a"].getters.token},page:{pageSize:10,pageNum:1,total:1e3,queryCondition:{product:""}},dialog:{title:"新增",visible:!1}}},created(){this.getSales()},computed:{},components:{FilterHeader:l["a"]},methods:{async getSales(){const{data:e}=await Object(o["e"])(this.page);200==e.code&&(this.sales=e.data.data,this.page.total=e.data.total)},openDialog(e){1==e?(this.form={},this.dialog.title="Add Sale"):(this.dialog.title="Update Sale",this.form={}),this.dialog.visible=!this.visible},async deleteSale(e){console.log(e);const{data:t}=await Object(o["b"])(e);200==t.code?(this.$message({type:"success",message:"delete successfully!"}),this.getSales()):this.$message({type:"warning",message:"delete fail!"})},update(e){this.updateForm=e,this.currentUpdateId=e.saleId},async confirmUpdate(){console.log(this.updateForm);const{data:e}=await Object(o["f"])(this.updateForm);200==e.code?(this.$message({type:"success",message:"update successfully!"}),this.updateForm={},this.currentUpdateId=0,this.getSales()):this.$message({type:"warning",message:"update fail!"})},cancelUpdate(){this.getSales(),this.updateForm={},this.currentUpdateId=0},async submit(){console.log(this.form);const{data:e}=await Object(o["d"])(this.form);200==e.code?(this.dialog.visible=!this.dialog.visible,this.$message({type:"success",message:"insert successfully!"}),this.form={},this.getSales()):this.$message({type:"warning",message:"insert fail!"})},async submitToBatch(){console.log(this.excelData);const{data:e}=Object(o["a"])(this.excelData);console.log(e)},handleSuccess(e){console.log(e),200==e.code&&(this.excelData=e.data,this.tableVisable=!0)},querySearch(e,t){console.log(e),t(this.products)},async getProducts(){const{data:e}=await Object(o["c"])();200==e.code&&(this.products=e.data)},handleCurrentChange(e){this.page.pageNum=e,this.getSales()},tableFilter(e,t){let i=!0;t||(this.conditionsFields.forEach(t=>{t.fieldName===e.fieldName&&(t.conditions=e.conditions,i=!1)}),i&&this.conditionsFields.push(e)),this.conditionsFields.filter((e,t)=>{console.log(t),"text"===e.filterType&&""!==e.conditions.text?this.page.queryCondition[e.fieldName]=e.conditions.text:"radio"===e.filterType&&""!==e.conditions.radio?this.page.queryCondition[e.fieldName]=e.conditions.radio:"date"===e.filterType&&(e.conditions.date1||e.conditions.date2)&&(this.page.queryCondition.startTime=e.conditions.date1,this.page.queryCondition.endTime=e.conditions.date2)}),this.getSales()},tableFilterReset(e){this.conditionsFields.forEach((t,i)=>{t.fieldName===e.fieldName&&("handlerDate"==t.fieldName&&(this.page.queryCondition.startTime="",this.page.queryCondition.endTime=""),this.page.queryCondition[t.fieldName]=null,this.conditionsFields.splice(i,1))}),0===this.conditionsFields.length?this.getSales():this.tableFilter(e,!0)}},mounted(){},watch:{"updateForm.saleIfi"(){this.updateForm.total=Number(this.updateForm.saleIfi)+Number(this.updateForm.saleDistrib)},"updateForm.saleDistrib"(){this.updateForm.total=Number(this.updateForm.saleIfi)+Number(this.updateForm.saleDistrib)}}},c=r,d=(i("768b"),i("2877")),u=Object(d["a"])(c,a,s,!1,null,"c6248508",null);t["default"]=u.exports},"0260":function(e,t,i){},"634c":function(e,t,i){},"768b":function(e,t,i){"use strict";i("0260")},"8dba":function(e,t,i){"use strict";i("634c")},c4c3:function(e,t,i){"use strict";i.d(t,"d",(function(){return o})),i.d(t,"b",(function(){return n})),i.d(t,"f",(function(){return l})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return c})),i.d(t,"e",(function(){return d}));var a=i("751a"),s=i("4360");function o(e){return Object(a["a"])({url:"/info_screen/sale/add",method:"post",data:e,headers:{token:s["a"].getters.token}})}function n(e){return Object(a["a"])({url:"/info_screen/sale/delete/"+e,method:"delete",headers:{token:s["a"].getters.token}})}function l(e){return Object(a["a"])({url:"/info_screen/sale/update",method:"post",data:e,headers:{token:s["a"].getters.token}})}function r(){return Object(a["a"])({url:"/info_screen/sale/products",method:"get",headers:{token:s["a"].getters.token}})}function c(e){return Object(a["a"])({url:"/info_screen/sale/batch",data:e,method:"post",headers:{token:s["a"].getters.token}})}function d(e){return Object(a["a"])({url:"/info_screen/sale/list/paged",method:"post",data:e,headers:{token:s["a"].getters.token}})}},d2c2:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{display:"inline-block"},on:{click:function(e){e.stopPropagation()}}},[i("el-popover",{ref:"popover",attrs:{placement:"bottom",title:"查询条件",width:"350",trigger:"click"}},["text"==e.filterType?i("div",[i("el-input",{attrs:{size:"mini",clearable:"",placeholder:"请输入查询内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$confirm()}},model:{value:e.conditions.text,callback:function(t){e.$set(e.conditions,"text","string"===typeof t?t.trim():t)},expression:"conditions.text"}})],1):"number"==e.filterType?i("div",[i("el-input",{attrs:{size:"mini",clearable:"",type:"number",step:"0.01",placeholder:"请输入开始数值"},model:{value:e.conditions.number1,callback:function(t){e.$set(e.conditions,"number1","string"===typeof t?t.trim():t)},expression:"conditions.number1"}}),i("el-input",{staticStyle:{"margin-top":"10px"},attrs:{size:"mini",clearable:"",step:"0.01",placeholder:"请输入结束数值"},model:{value:e.conditions.number2,callback:function(t){e.$set(e.conditions,"number2","string"===typeof t?t.trim():t)},expression:"conditions.number2"}})],1):"date"==e.filterType?i("div",[i("el-date-picker",{attrs:{type:"date",clearable:"",size:"mini",placeholder:"开始时间","value-format":"yyyy-MM-dd"},model:{value:e.conditions.date1,callback:function(t){e.$set(e.conditions,"date1",t)},expression:"conditions.date1"}}),i("el-date-picker",{staticStyle:{"margin-top":"10px"},attrs:{type:"date",size:"mini",clearable:"",placeholder:"结束时间","value-format":"yyyy-MM-dd"},model:{value:e.conditions.date2,callback:function(t){e.$set(e.conditions,"date2",t)},expression:"conditions.date2"}})],1):"select"==e.filterType?i("div",[i("el-select",{attrs:{placeholder:"请选择",size:"mini",clearable:""},model:{value:e.conditions.select,callback:function(t){e.$set(e.conditions,"select",t)},expression:"conditions.select"}},e._l(e.customArrList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):"checkbox"==e.filterType?i("div",[i("el-checkbox-group",{model:{value:e.conditions.checkbox,callback:function(t){e.$set(e.conditions,"checkbox",t)},expression:"conditions.checkbox"}},e._l(e.customArrList,(function(t,a){return i("el-checkbox",{key:a,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1):"radio"==e.filterType?i("div",[i("el-radio-group",{model:{value:e.conditions.radio,callback:function(t){e.$set(e.conditions,"radio",t)},expression:"conditions.radio"}},e._l(e.customArrList,(function(t,a){return i("el-radio",{key:a,attrs:{label:t.value,border:"",size:"mini"}},[e._v(e._s(t.label))])})),1)],1):e._e(),i("div",{staticClass:"text-right"},[i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.reset}},[e._v("重置")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确定")])],1),i("span",{class:e.labelColor,attrs:{slot:"reference",onselectstart:"return false",oncontextmenu:"return false"},slot:"reference"},[e._v(e._s(e.column.label)+" "),i("i")])])],1)},s=[],o={name:"FilterHeader",props:{column:{type:Object,defalut:null},fieldName:{type:String,defalut:""},filterType:{type:String,defalut:"txt"},customArrList:{type:Array,defalut:[]}},data(){return{conditions:{text:"",number1:"",number2:"",date1:"",date2:"",select:"",checkbox:[],radio:""}}},computed:{labelColor(){switch(this.filterType){case"text":return this.conditions.text?"heighLight":"";case"number":return this.conditions.number1||this.conditions.number2?"heighLight":"";case"date":return this.conditions.date1||this.conditions.date2?"heighLight":"";case"select":return this.conditions.select?"heighLight":"";case"checkbox":return this.conditions.checkbox.length>0?"heighLight":"";case"radio":return""!==this.conditions.radio?"heighLight":""}return""}},methods:{confirm(){console.log("子组件内"),this.$refs.popover.doClose(),this.$emit("tableFilter",{filterType:this.filterType,fieldName:this.fieldName,conditions:this.conditions})},reset(){switch(this.filterType){case"text":this.conditions.text="";break;case"number":this.conditions.number1="",this.conditions.number2="";break;case"date":this.conditions.date1="",this.conditions.date2="";break;case"select":this.conditions.select="";break;case"checkbox":this.conditions.checkbox=[];break;case"radio":this.conditions.radio="";break}this.$refs.popover.doClose(),this.$emit("resetFilter",{filterType:this.filterType,fieldName:this.fieldName,conditions:this.conditions})}}},n=o,l=(i("8dba"),i("2877")),r=Object(l["a"])(n,a,s,!1,null,"0bcd5a9a",null);t["a"]=r.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b2282d18"],{"16ff":function(e,t,r){},2491:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-container"},[r("pageHeader",{attrs:{title:e.$t("role.pageTitle"),describe:e.$t("role.pageDesc")}}),r("el-button",{staticStyle:{"margin-bottom":"12px","margin-left":"1rem"},attrs:{type:"primary",size:"mini"},on:{click:e.openAdd}},[r("i",{staticClass:"el-icon-plus"}),e._v(e._s(e.$t("role.add")))]),r("el-table",{attrs:{data:e.records,stripe:"",border:""}},[r("el-table-column",{attrs:{align:"center",label:e.$t("role.index"),type:"index",width:"60"}}),r("el-table-column",{attrs:{prop:"roleName",label:e.$t("role.role"),align:"center"}}),r("el-table-column",{attrs:{label:e.$t("role.operation"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticStyle:{display:"flex","justify-content":"center",cursor:"pointer"}},[r("div",{staticStyle:{color:"#409eff"},on:{click:function(r){return e.openDialog(t.row)}}},[r("span",[e._v(e._s(e.$t("role.edit")))])]),1!==t.row.roleId&&15!==t.row.roleId?r("div",{staticStyle:{color:"#409eff","margin-left":"10px"},on:{click:function(r){return e.delectById(t.row.roleId)}}},[r("span",[e._v(e._s(e.$t("role.delete")))])]):e._e(),r("div",{staticStyle:{color:"#409eff","margin-left":"10px"},on:{click:function(r){return e.assignMenu(t.row)}}},[r("span",[e._v(e._s(e.$t("role.assignMenu")))])]),r("div",{staticStyle:{color:"#409eff","margin-left":"10px"},on:{click:function(r){return e.assignResource(t.row)}}},[r("span",[e._v(e._s(e.$t("role.assignResource")))])])])]}}])})],1),r("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.visible,width:"35%"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[r("el-form",{ref:"formData",attrs:{"status-icon":"",rules:e.rules,model:e.formData,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"角色名称:",prop:"roleName"}},[r("el-input",{attrs:{type:"text"},model:{value:e.formData.roleName,callback:function(t){e.$set(e.formData,"roleName",t)},expression:"formData.roleName"}})],1),r("el-button",{staticClass:"sub-button",attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.submitForm("formData")}}},[e._v(e._s(e.$t("role.confirm")))])],1)],1),r("el-drawer",{attrs:{title:e.drawer1.title,visible:e.drawer1.visible,direction:"rtl",size:"20%"},on:{"update:visible":function(t){return e.$set(e.drawer1,"visible",t)}}},[r("assignMenu",{key:e.role.roleId,attrs:{role:e.role},on:{fatherMethod:e.setDrawer1}})],1),r("el-drawer",{attrs:{title:e.drawer2.title,visible:e.drawer2.visible,direction:"rtl",size:"20%"},on:{"update:visible":function(t){return e.$set(e.drawer2,"visible",t)}}},[r("assignResource",{key:e.role.roleId,attrs:{role:e.role},on:{fatherMethod:e.setDrawer2}})],1)],1)},a=[],o=r("8593"),n=r("cc5e"),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"assign-menu-container"},[r("el-tree",{ref:"tree",attrs:{data:e.menus,"show-checkbox":"","node-key":"id","default-expanded-keys":[1,6,19],"default-checked-keys":e.menuIds,props:e.defaultProps,"check-strictly":!0}}),r("el-button",{staticStyle:{display:"block",margin:"10px auto"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)},c=[],l={components:{},name:"assign-menu",props:{role:{type:Object,required:!0}},data(){return{menus:[],defaultProps:{label:"title"},menuIds:[]}},computed:{},watch:{},methods:{async getMenus(){const{data:e}=await Object(o["g"])();200==e.code?this.menus=e.data:this.$message({type:"warning",message:e.msg})},async getMenuIds(e){const{data:t}=await Object(n["e"])(e);200==t.code?this.menuIds=t.data:this.$message({type:"warning",message:t.msg})},async submit(){const e=await this.$refs.tree.getCheckedNodes(!1,!0),t=[];for(let s=0;s<e.length;s++)t[s]=e[s].id;console.log(t);const{data:r}=await Object(n["b"])(this.role.roleId,t);200==r.code?(this.getMenuIds(this.role.roleId),this.$emit("fatherMethod"),this.$message({type:"success",message:"分配成功"})):this.$message({type:"warning",message:r.msg})}},created(){this.getMenus(),this.getMenuIds(this.role.roleId)},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){}},d=l,u=(r("3e35"),r("2877")),h=Object(u["a"])(d,i,c,!1,null,"5889cedc",null),f=h.exports,m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"assign-resource-container"},[e._l(e.resources,(function(t){return r("div",{staticClass:"check-box",staticStyle:{margin:"70px"}},[r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v(e._s(t.categoryName))]),r("div",{staticStyle:{margin:"15px 0"}}),r("el-checkbox-group",{model:{value:e.checkedResources,callback:function(t){e.checkedResources=t},expression:"checkedResources"}},e._l(t.resources,(function(t){return r("el-checkbox",{key:t.id,staticStyle:{padding:"3px"},attrs:{label:t.id}},[e._v(e._s(t.description))])})),1)],1)})),r("el-button",{staticStyle:{display:"block",margin:"10px auto"},attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],2)},g=[],p={components:{},name:"assign-resource",props:{role:{type:Object,required:!0}},data(){return{resources:[],checkedResources:[3,5,7],isIndeterminate:!0,checkAll:!1,queryCondition:{category:"",name:"",url:""}}},computed:{},watch:{},methods:{handleCheckAllChange(e){this.checkedResources=e?this.resources:[],this.isIndeterminate=!1},async getResource(){const{data:e}=await Object(o["i"])(this.queryCondition);200==e.code?this.resources=e.data:this.$message({type:"warning",message:e.msg});const{data:t}=await Object(o["j"])(this.queryCondition);200==t.code?this.resources=t.data:this.$message({type:"warning",message:e.msg})},async getCheckedResources(e){const{data:t}=await Object(n["f"])(e);200==t.code?this.checkedResources=t.data:this.$message({type:"warning",message:t.msg})},async submit(){console.log(this.checkedResources);const{data:e}=await Object(n["c"])(this.role.roleId,this.checkedResources);200==e.code?(this.getCheckedResources(this.role.roleId),this.$emit("fatherMethod"),this.$message({type:"success",message:"分配成功"})):this.$message({type:"warning",message:e.msg})}},created(){this.getResource(),this.getCheckedResources(this.role.roleId)},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){}},b=p,k=(r("eecb"),Object(u["a"])(b,m,g,!1,null,"167d9299",null)),y=k.exports,v=r("e965"),w={components:{assignMenu:f,assignResource:y,pageHeader:v["a"]},data(){return{records:[],dialog:{visible:!1,title:""},formData:{},rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},roleId:0,drawer1:{title:"",visible:!1},drawer2:{title:"",visible:!1},role:{}}},created(){this.getRoleList()},methods:{delectById(e){this.$confirm("确认删除此角色吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(n["d"])(e).then(e=>{200==e.data.code?(this.$message.success("删除成功"),this.getRoleList()):this.$message.error("删除失败")})}).catch(e=>{console.log(e)})},openDialog(e){this.formData.roleName=e.roleName,this.formData.roleId=e.roleId,this.dialog.visible=!0,this.dialog.title="更新",this.$nextTick(()=>{this.$refs.formData.clearValidate()})},submitForm(e){this.$refs[e].validate(e=>{if(!e)return!1;this.submitData()})},async submitData(){let e={roleId:this.formData.roleId,roleName:this.formData.roleName},t=null;"新增"==this.dialog.title?(t=await Object(n["a"])(e),console.log("response1",t)):(t=await Object(n["h"])(e),console.log("response1",t)),this.$message({type:200==t.data.code?"success":"error",message:200==t.data.code?"保存成功":"保存失败"}),this.$refs["formData"].resetFields(),this.dialog.visible=!1,this.getRoleList()},openAdd(){this.formData={},this.formData.roleId=0,this.dialog.visible=!0,this.dialog.title="新增",this.$nextTick(()=>{this.$refs.formData.clearValidate()})},async getRoleList(){const{data:e}=await Object(o["k"])();this.records=e.data,console.log(this.records)},assignMenu(e){this.role=e,this.drawer1.title="分配菜单："+e.roleName,this.drawer1.visible=!0},assignResource(e){this.role=e,this.drawer2.title="分配资源权限："+e.roleName,this.drawer2.visible=!0},setDrawer1(){console.log("调用父方法"),this.drawer1.visible=!1},setDrawer2(){console.log("调用父方法"),this.drawer2.visible=!1}}},_=w,$=(r("53b9"),Object(u["a"])(_,s,a,!1,null,"53ddc82c",null));t["default"]=$.exports},"3e35":function(e,t,r){"use strict";r("eeec")},"3e54":function(e,t,r){"use strict";r("9cc8")},"454b":function(e,t,r){},"53b9":function(e,t,r){"use strict";r("16ff")},8593:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"f",(function(){return n})),r.d(t,"m",(function(){return i})),r.d(t,"r",(function(){return c})),r.d(t,"l",(function(){return l})),r.d(t,"q",(function(){return d})),r.d(t,"k",(function(){return u})),r.d(t,"g",(function(){return h})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return m})),r.d(t,"d",(function(){return g})),r.d(t,"o",(function(){return p})),r.d(t,"b",(function(){return b})),r.d(t,"e",(function(){return k})),r.d(t,"p",(function(){return y})),r.d(t,"h",(function(){return v})),r.d(t,"a",(function(){return w})),r.d(t,"n",(function(){return _}));var s=r("751a"),a=r("4360");function o(e){return Object(s["a"])({url:"/info_screen/user/assignRole",method:"post",data:e,headers:{token:a["a"].getters.token}})}function n(e){return Object(s["a"])({url:"/info_screen/user/delete/"+e,method:"delete",headers:{token:a["a"].getters.token}})}function i(e){return Object(s["a"])({url:"/info_screen/user/save",method:"POST",data:e})}function c(e){return Object(s["a"])({url:"/info_screen/user/update/v",method:"POST",data:e})}function l(e){return Object(s["a"])({url:"/info_screen/user",method:"post",data:e,headers:{token:a["a"].getters.token}})}function d(e,t){return Object(s["a"])({url:"/info_screen/user/state/"+e+"/"+t,method:"put",headers:{token:a["a"].getters.token}})}function u(){return Object(s["a"])({url:"/info_screen/role/list",method:"get",headers:{token:a["a"].getters.token}})}function h(){return Object(s["a"])({url:"/info_screen/menu/list",method:"get",headers:{token:a["a"].getters.token}})}function f(e){return Object(s["a"])({url:"/info_screen/resource/list",method:"post",data:e,headers:{token:a["a"].getters.token}})}function m(e){return Object(s["a"])({url:"/info_screen/resource/list/category",method:"post",data:e,headers:{token:a["a"].getters.token}})}function g(e){return Object(s["a"])({url:"/info_screen/resource/delete/"+e,method:"delete",headers:{token:a["a"].getters.token}})}function p(e){return Object(s["a"])({url:"/info_screen/resource/update",method:"put",data:e,headers:{token:a["a"].getters.token}})}function b(e){return Object(s["a"])({url:"/info_screen/resourceCategory/add",method:"post",data:e,headers:{token:a["a"].getters.token}})}function k(e){return Object(s["a"])({url:"/info_screen/resourceCategory/delete/"+e,method:"delete",headers:{token:a["a"].getters.token}})}function y(e){return Object(s["a"])({url:"info_screen/resourceCategory/update",method:"put",data:e,headers:{token:a["a"].getters.token}})}function v(){return Object(s["a"])({url:"/info_screen/resourceCategory/list",method:"get",headers:{token:a["a"].getters.token}})}function w(e){return Object(s["a"])({url:"/info_screen/resource/add",method:"post",data:e,headers:{token:a["a"].getters.token}})}function _(){return Object(s["a"])({url:"/info_screen/resourceCategory/searchList",method:"get",headers:{token:a["a"].getters.token}})}},"9cc8":function(e,t,r){},e965:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container",staticStyle:{background:"#fff",height:"100px",padding:"10px 0"}},[r("div",{staticClass:"title",staticStyle:{"font-size":"30px",padding:"10px"}},[e._v(e._s(e.title))]),r("div",{staticClass:"content",staticStyle:{"font-size":"15px",padding:"10px",color:"#888"}},[e._v(e._s(e.describe)+" ")])])},a=[],o={components:{},name:"pageHeader",props:{title:{type:String,default:null},describe:{type:String,default:null}},data(){return{}},computed:{},watch:{},methods:{},created(){},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){}},n=o,i=(r("3e54"),r("2877")),c=Object(i["a"])(n,s,a,!1,null,"32773f74",null);t["a"]=c.exports},eecb:function(e,t,r){"use strict";r("454b")},eeec:function(e,t,r){}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78eb58e6"],{3099:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-container"},[r("pageHeader",{attrs:{title:e.$t("user.pageTitle"),describe:e.$t("user.pageDesc")}}),r("el-form",{staticClass:"form-box",staticStyle:{display:"flex",width:"calc(100% - 1rem)","padding-left":"1rem"},attrs:{inline:!0,size:"mini"}},[r("el-form-item",{attrs:{label:e.$t("user.username")}},[r("el-input",{attrs:{clearable:"",placeholder:e.$t("user.usernamePlaceHolder")},model:{value:e.page.queryCondition.username,callback:function(t){e.$set(e.page.queryCondition,"username",t)},expression:"page.queryCondition.username"}})],1),r("el-form-item",{attrs:{label:e.$t("user.phone")}},[r("el-input",{attrs:{clearable:"",placeholder:e.$t("user.phonePlaceHolder")},model:{value:e.page.queryCondition.phone,callback:function(t){e.$set(e.page.queryCondition,"phone",t)},expression:"page.queryCondition.phone"}})],1),r("el-form-item",{staticStyle:{"margin-right":"1px"}},[r("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.getUserList}},[e._v(e._s(e.$t("user.query")))]),r("el-button",{staticStyle:{"margin-left":"15px"},attrs:{icon:"el-icon-edit",type:"primary"},on:{click:function(t){e.saveDialog=!0}}},[e._v(e._s(e.$t("user.save")))])],1)],1),r("el-table",{attrs:{data:e.records,stripe:"",border:""}},[r("el-table-column",{attrs:{align:"center",label:e.$t("user.index"),type:"index",width:"60"}}),r("el-table-column",{attrs:{prop:"username",label:e.$t("user.username"),align:"center"}}),r("el-table-column",{attrs:{prop:"phone",label:e.$t("user.phone"),align:"center"}}),r("el-table-column",{attrs:{prop:"email",label:e.$t("user.email"),align:"center"}}),r("el-table-column",{attrs:{prop:"roleList",label:e.$t("user.role"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(0==t.row.roleList.length?"暂未分配":t.row.roleList))])]}}])}),r("el-table-column",{attrs:{prop:"state",label:e.$t("user.freezing"),width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(r){return e.changeState(t.row)}},model:{value:t.row.state,callback:function(r){e.$set(t.row,"state",r)},expression:"scope.row.state"}})]}}])}),r("el-table-column",{attrs:{prop:"gmtCreate",label:e.$t("user.createAt"),align:"center"}}),r("el-table-column",{attrs:{prop:"gmtModified",label:e.$t("user.updateAt"),align:"center"}}),r("el-table-column",{attrs:{label:e.$t("user.operation"),align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticStyle:{display:"flex","justify-content":"center",cursor:"pointer"}},[r("div",{staticStyle:{color:"#409eff"},on:{click:function(r){return e.openDialog(t.row.roles,t.row.userId)}}},[r("span",[e._v(e._s(e.$t("user.assignRole")))])]),r("div",{staticStyle:{color:"#409eff","margin-left":"10px"},on:{click:function(r){return e.openUpdate(t.row)}}},[r("span",[e._v(e._s(e.$t("user.edit")))])]),r("div",{staticStyle:{color:"#409eff","margin-left":"10px"},on:{click:function(r){return e.delectById(t.row.userId)}}},[r("span",[e._v(e._s(e.$t("user.delete")))])])])]}}])})],1),r("el-pagination",{staticStyle:{float:"right","margin-bottom":"20px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.page.pageNum,total:e.page.total,"page-size":e.page.pageSize},on:{"update:currentPage":function(t){return e.$set(e.page,"pageNum",t)},"update:current-page":function(t){return e.$set(e.page,"pageNum",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),r("el-dialog",{attrs:{title:e.$t("user.dialogTitle1"),visible:e.visible,width:"35%"},on:{"update:visible":function(t){e.visible=t}}},[r("el-form",{attrs:{model:e.form,"label-width":"120px"}},[r("el-checkbox-group",{staticClass:"el-checkbox-style",attrs:{max:1,min:0},model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}},e._l(e.roleList,(function(e){return r("el-checkbox",{key:e.roleId,staticClass:"el-checkbox-item",attrs:{label:e.roleName}})})),1),r("el-button",{staticClass:"sub-button",staticStyle:{margin:"1rem auto",display:"block"},attrs:{size:"mini",type:"primary"},on:{click:e.submit}},[e._v(e._s(e.$t("user.confirm")))])],1)],1),r("el-dialog",{attrs:{title:e.$t("user.save"),visible:e.saveDialog,width:"35%"},on:{"update:visible":function(t){e.saveDialog=t}}},[r("el-form",{ref:"saveForm",attrs:{model:e.saveForm,"label-width":"120px",size:"mini",rules:e.rules}},[r("el-form-item",{attrs:{label:e.$t("user.username"),prop:"username"}},[r("el-input",{attrs:{clearable:""},model:{value:e.saveForm.username,callback:function(t){e.$set(e.saveForm,"username",t)},expression:"saveForm.username"}})],1),r("el-form-item",{attrs:{label:e.$t("user.password"),prop:"password"}},[r("el-input",{attrs:{type:"password",clearable:""},model:{value:e.saveForm.password,callback:function(t){e.$set(e.saveForm,"password",t)},expression:"saveForm.password"}})],1),r("el-form-item",{attrs:{label:e.$t("user.phone"),prop:"phone"}},[r("el-input",{attrs:{clearable:""},model:{value:e.saveForm.phone,callback:function(t){e.$set(e.saveForm,"phone",t)},expression:"saveForm.phone"}})],1),r("el-form-item",{attrs:{label:e.$t("user.email"),prop:"email"}},[r("el-input",{attrs:{clearable:""},model:{value:e.saveForm.email,callback:function(t){e.$set(e.saveForm,"email",t)},expression:"saveForm.email"}})],1),r("el-button",{staticClass:"sub-button",staticStyle:{margin:"1rem auto",display:"block"},attrs:{size:"mini",type:"primary"},on:{click:e.submitSave}},[e._v("confirm")])],1)],1),r("el-dialog",{attrs:{title:e.$t("user.edit"),visible:e.updateDialog,width:"35%"},on:{"update:visible":function(t){e.updateDialog=t}}},[r("el-form",{ref:"updateForm",attrs:{model:e.updateForm,"label-width":"120px",size:"mini",rules:e.updateRules}},[r("el-form-item",{attrs:{label:e.$t("user.username"),prop:"username"}},[r("el-input",{attrs:{clearable:""},model:{value:e.updateForm.username,callback:function(t){e.$set(e.updateForm,"username",t)},expression:"updateForm.username"}})],1),r("el-form-item",{attrs:{label:e.$t("user.phone"),prop:"phone"}},[r("el-input",{attrs:{clearable:""},model:{value:e.updateForm.phone,callback:function(t){e.$set(e.updateForm,"phone",t)},expression:"updateForm.phone"}})],1),r("el-form-item",{attrs:{label:e.$t("user.email"),prop:"email"}},[r("el-input",{attrs:{clearable:""},model:{value:e.updateForm.email,callback:function(t){e.$set(e.updateForm,"email",t)},expression:"updateForm.email"}})],1),r("el-button",{staticClass:"sub-button",staticStyle:{margin:"1rem auto",display:"block"},attrs:{size:"mini",type:"primary"},on:{click:e.submitUpdate}},[e._v("confirm")])],1)],1)],1)},s=[],n=(r("14d9"),r("e965")),o=r("4360"),i=r("8593"),l={components:{pageHeader:n["a"]},data(){return{records:[],visible:!1,saveDialog:!1,updateDialog:!1,form:{},roleList:[],roles:[],userId:"",currentAdminId:"",queryCondition:{},rules:{username:[{required:!0,message:"username is required",trigger:"blur"}],password:[{required:!0,message:"password is required",trigger:"blur"}]},updateRules:{username:[{required:!0,message:"username is required",trigger:"blur"}]},saveForm:{username:"",password:"",phone:"",email:"",state:""},updateForm:{userId:"",username:"",password:"",phone:"",email:"",state:""},page:{pageSize:10,pageNum:1,total:1e3,queryCondition:{}},role:o["a"].getters.role}},created(){this.userId=localStorage.getItem("username"),this.getUserList(),this.getRoleList()},methods:{openUpdate(e){this.updateForm=JSON.parse(JSON.stringify(e)),this.updateDialog=!0},submitUpdate(){this.$refs["updateForm"].validate(e=>{if(!e)return console.log("error submit!!"),!1;Object(i["r"])(this.updateForm).then(()=>{this.$message.success("Success"),this.updateDialog=!1,setTimeout(()=>{this.getUserList()},10)})})},submitSave(){this.$refs["saveForm"].validate(e=>{if(!e)return console.log("error submit!!"),!1;Object(i["m"])(this.saveForm).then(()=>{this.$message.success("Success"),this.saveDialog=!1,setTimeout(()=>{this.resetForm("saveForm"),this.getUserList()},10)})})},resetForm(e){this.$refs[e].resetFields()},async getRoleList(){const{data:e}=await Object(i["k"])();let t=e.data;this.roleList=t},openDialog(e,t){let r=[];for(let a=0;a<e.length;a++)r.push(e[a].roleName);this.visible=!0,this.roles=r,this.currentAdminId=t,this.form={}},async submit(){var e=this;let t=[];e.roleList.forEach((function(r){e.roles.includes(r.roleName)&&t.push(r.roleId)}));let r={roleIds:t,userId:this.currentAdminId};await Object(i["c"])(r).then(()=>{e.$message.success("分配成功"),e.visible=!1,e.getUserList()})},async delectById(e){this.$confirm("确认删除此用户吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{data:t}=await Object(i["f"])(e);200==t.code?(this.$message({type:"success",message:"Delete user successfully!"}),this.getUserList()):this.$message({type:"warning",message:"Failed to delete user!"})}).catch(e=>{this.$message({type:"info",message:this.$t("clock.cancelTooltip")})})},async getUserList(){var e=this;const{data:t}=await Object(i["l"])(this.page);console.log(t);let r=t.data.data;this.page.total=t.data.total,r.forEach((function(t,a){r[a].roleList=e.getRole(t.roles)})),this.records=r},getRole(e){let t="";return e.forEach((function(e){t+=(t?",":"")+e.roleName})),t},handleCurrentChange(e){this.page.pageNum=e,this.getUserList()},handleSizeChange(e){this.page.pageSize=e,this.getUserList()},async changeState(e){if(this.$store.getters.username==e.username)this.$message({type:"warning",message:"Cannot modify your own status."});else{const{data:t}=await Object(i["q"])(e.username,e.state);200==t.code?this.$message({type:"success",message:"Updating state successfully."}):this.$message({type:"warning",message:"Updating state fail."})}this.getUserList()}}},u=l,c=(r("3213"),r("2877")),d=Object(c["a"])(u,a,s,!1,null,"42c0ac2e",null);t["default"]=d.exports},3213:function(e,t,r){"use strict";r("94fd")},"3e54":function(e,t,r){"use strict";r("9cc8")},8593:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"f",(function(){return o})),r.d(t,"m",(function(){return i})),r.d(t,"r",(function(){return l})),r.d(t,"l",(function(){return u})),r.d(t,"q",(function(){return c})),r.d(t,"k",(function(){return d})),r.d(t,"g",(function(){return p})),r.d(t,"i",(function(){return m})),r.d(t,"j",(function(){return f})),r.d(t,"d",(function(){return g})),r.d(t,"o",(function(){return h})),r.d(t,"b",(function(){return b})),r.d(t,"e",(function(){return v})),r.d(t,"p",(function(){return y})),r.d(t,"h",(function(){return k})),r.d(t,"a",(function(){return $})),r.d(t,"n",(function(){return w}));var a=r("751a"),s=r("4360");function n(e){return Object(a["a"])({url:"/info_screen/user/assignRole",method:"post",data:e,headers:{token:s["a"].getters.token}})}function o(e){return Object(a["a"])({url:"/info_screen/user/delete/"+e,method:"delete",headers:{token:s["a"].getters.token}})}function i(e){return Object(a["a"])({url:"/info_screen/user/save",method:"POST",data:e})}function l(e){return Object(a["a"])({url:"/info_screen/user/update/v",method:"POST",data:e})}function u(e){return Object(a["a"])({url:"/info_screen/user",method:"post",data:e,headers:{token:s["a"].getters.token}})}function c(e,t){return Object(a["a"])({url:"/info_screen/user/state/"+e+"/"+t,method:"put",headers:{token:s["a"].getters.token}})}function d(){return Object(a["a"])({url:"/info_screen/role/list",method:"get",headers:{token:s["a"].getters.token}})}function p(){return Object(a["a"])({url:"/info_screen/menu/list",method:"get",headers:{token:s["a"].getters.token}})}function m(e){return Object(a["a"])({url:"/info_screen/resource/list",method:"post",data:e,headers:{token:s["a"].getters.token}})}function f(e){return Object(a["a"])({url:"/info_screen/resource/list/category",method:"post",data:e,headers:{token:s["a"].getters.token}})}function g(e){return Object(a["a"])({url:"/info_screen/resource/delete/"+e,method:"delete",headers:{token:s["a"].getters.token}})}function h(e){return Object(a["a"])({url:"/info_screen/resource/update",method:"put",data:e,headers:{token:s["a"].getters.token}})}function b(e){return Object(a["a"])({url:"/info_screen/resourceCategory/add",method:"post",data:e,headers:{token:s["a"].getters.token}})}function v(e){return Object(a["a"])({url:"/info_screen/resourceCategory/delete/"+e,method:"delete",headers:{token:s["a"].getters.token}})}function y(e){return Object(a["a"])({url:"info_screen/resourceCategory/update",method:"put",data:e,headers:{token:s["a"].getters.token}})}function k(){return Object(a["a"])({url:"/info_screen/resourceCategory/list",method:"get",headers:{token:s["a"].getters.token}})}function $(e){return Object(a["a"])({url:"/info_screen/resource/add",method:"post",data:e,headers:{token:s["a"].getters.token}})}function w(){return Object(a["a"])({url:"/info_screen/resourceCategory/searchList",method:"get",headers:{token:s["a"].getters.token}})}},"94fd":function(e,t,r){},"9cc8":function(e,t,r){},e965:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container",staticStyle:{background:"#fff",height:"100px",padding:"10px 0"}},[r("div",{staticClass:"title",staticStyle:{"font-size":"30px",padding:"10px"}},[e._v(e._s(e.title))]),r("div",{staticClass:"content",staticStyle:{"font-size":"15px",padding:"10px",color:"#888"}},[e._v(e._s(e.describe)+" ")])])},s=[],n={components:{},name:"pageHeader",props:{title:{type:String,default:null},describe:{type:String,default:null}},data(){return{}},computed:{},watch:{},methods:{},created(){},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){}},o=n,i=(r("3e54"),r("2877")),l=Object(i["a"])(o,a,s,!1,null,"32773f74",null);t["a"]=l.exports}}]);
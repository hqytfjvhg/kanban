(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ef44da78"],{"4e7b":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"f",(function(){return s})),i.d(t,"d",(function(){return l})),i.d(t,"b",(function(){return c})),i.d(t,"e",(function(){return d}));var o=i("751a"),n=i("4360");function a(e){return Object(o["a"])({url:"/info_screen/overstock/add",method:"post",data:e,headers:{token:n["a"].getters.token}})}function r(e){return Object(o["a"])({url:"/info_screen/overstock/delete/"+e,method:"delete",headers:{token:n["a"].getters.token}})}function s(e){return Object(o["a"])({url:"/info_screen/overstock/update",method:"post",headers:{token:n["a"].getters.token},data:e})}function l(){return Object(o["a"])({url:"/info_screen/overstock/products",method:"get",headers:{token:n["a"].getters.token}})}function c(e){return Object(o["a"])({url:"/info_screen/overstock/batch",method:"post",data:e,headers:{token:n["a"].getters.token}})}function d(e){return Object(o["a"])({url:"/info_screen/overstock/list/paged",method:"post",data:e,headers:{token:n["a"].getters.token}})}},"634c":function(e,t,i){},"7b85":function(e,t,i){"use strict";i("85b0")},"85b0":function(e,t,i){},"8dba":function(e,t,i){"use strict";i("634c")},d2c2:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{display:"inline-block"},on:{click:function(e){e.stopPropagation()}}},[i("el-popover",{ref:"popover",attrs:{placement:"bottom",title:"查询条件",width:"350",trigger:"click"}},["text"==e.filterType?i("div",[i("el-input",{attrs:{size:"mini",clearable:"",placeholder:"请输入查询内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$confirm()}},model:{value:e.conditions.text,callback:function(t){e.$set(e.conditions,"text","string"===typeof t?t.trim():t)},expression:"conditions.text"}})],1):"number"==e.filterType?i("div",[i("el-input",{attrs:{size:"mini",clearable:"",type:"number",step:"0.01",placeholder:"请输入开始数值"},model:{value:e.conditions.number1,callback:function(t){e.$set(e.conditions,"number1","string"===typeof t?t.trim():t)},expression:"conditions.number1"}}),i("el-input",{staticStyle:{"margin-top":"10px"},attrs:{size:"mini",clearable:"",step:"0.01",placeholder:"请输入结束数值"},model:{value:e.conditions.number2,callback:function(t){e.$set(e.conditions,"number2","string"===typeof t?t.trim():t)},expression:"conditions.number2"}})],1):"date"==e.filterType?i("div",[i("el-date-picker",{attrs:{type:"date",clearable:"",size:"mini",placeholder:"开始时间","value-format":"yyyy-MM-dd"},model:{value:e.conditions.date1,callback:function(t){e.$set(e.conditions,"date1",t)},expression:"conditions.date1"}}),i("el-date-picker",{staticStyle:{"margin-top":"10px"},attrs:{type:"date",size:"mini",clearable:"",placeholder:"结束时间","value-format":"yyyy-MM-dd"},model:{value:e.conditions.date2,callback:function(t){e.$set(e.conditions,"date2",t)},expression:"conditions.date2"}})],1):"select"==e.filterType?i("div",[i("el-select",{attrs:{placeholder:"请选择",size:"mini",clearable:""},model:{value:e.conditions.select,callback:function(t){e.$set(e.conditions,"select",t)},expression:"conditions.select"}},e._l(e.customArrList,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):"checkbox"==e.filterType?i("div",[i("el-checkbox-group",{model:{value:e.conditions.checkbox,callback:function(t){e.$set(e.conditions,"checkbox",t)},expression:"conditions.checkbox"}},e._l(e.customArrList,(function(t,o){return i("el-checkbox",{key:o,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1):"radio"==e.filterType?i("div",[i("el-radio-group",{model:{value:e.conditions.radio,callback:function(t){e.$set(e.conditions,"radio",t)},expression:"conditions.radio"}},e._l(e.customArrList,(function(t,o){return i("el-radio",{key:o,attrs:{label:t.value,border:"",size:"mini"}},[e._v(e._s(t.label))])})),1)],1):e._e(),i("div",{staticClass:"text-right"},[i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.reset}},[e._v("重置")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确定")])],1),i("span",{class:e.labelColor,attrs:{slot:"reference",onselectstart:"return false",oncontextmenu:"return false"},slot:"reference"},[e._v(e._s(e.column.label)+" "),i("i")])])],1)},n=[],a={name:"FilterHeader",props:{column:{type:Object,defalut:null},fieldName:{type:String,defalut:""},filterType:{type:String,defalut:"txt"},customArrList:{type:Array,defalut:[]}},data(){return{conditions:{text:"",number1:"",number2:"",date1:"",date2:"",select:"",checkbox:[],radio:""}}},computed:{labelColor(){switch(this.filterType){case"text":return this.conditions.text?"heighLight":"";case"number":return this.conditions.number1||this.conditions.number2?"heighLight":"";case"date":return this.conditions.date1||this.conditions.date2?"heighLight":"";case"select":return this.conditions.select?"heighLight":"";case"checkbox":return this.conditions.checkbox.length>0?"heighLight":"";case"radio":return""!==this.conditions.radio?"heighLight":""}return""}},methods:{confirm(){console.log("子组件内"),this.$refs.popover.doClose(),this.$emit("tableFilter",{filterType:this.filterType,fieldName:this.fieldName,conditions:this.conditions})},reset(){switch(this.filterType){case"text":this.conditions.text="";break;case"number":this.conditions.number1="",this.conditions.number2="";break;case"date":this.conditions.date1="",this.conditions.date2="";break;case"select":this.conditions.select="";break;case"checkbox":this.conditions.checkbox=[];break;case"radio":this.conditions.radio="";break}this.$refs.popover.doClose(),this.$emit("resetFilter",{filterType:this.filterType,fieldName:this.fieldName,conditions:this.conditions})}}},r=a,s=(i("8dba"),i("2877")),l=Object(s["a"])(r,o,n,!1,null,"0bcd5a9a",null);t["a"]=l.exports},fae1:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"overstock-container",attrs:{id:"overstock"}},[i("el-form",{staticClass:"form-box",staticStyle:{display:"flex",width:"100%"},attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"subject:"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入subject"},model:{value:e.page.queryCondition.subject,callback:function(t){e.$set(e.page.queryCondition,"subject",t)},expression:"page.queryCondition.subject"}})],1),i("el-form-item",{attrs:{label:"year:"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入year"},model:{value:e.page.queryCondition.year,callback:function(t){e.$set(e.page.queryCondition,"year",t)},expression:"page.queryCondition.year"}})],1),i("el-form-item",{attrs:{label:"month:"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入month"},model:{value:e.page.queryCondition.month,callback:function(t){e.$set(e.page.queryCondition,"month",t)},expression:"page.queryCondition.month"}})],1),i("el-form-item",{staticStyle:{"margin-right":"10px"}},[i("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.getProjects}},[e._v("查询")])],1)],1),i("div",{staticClass:"new-create"},[i("el-button",{staticClass:"create-button",attrs:{type:"success",size:"mini"},on:{click:function(t){return e.openDialog(1)}}},[e._v("新增")]),i("el-upload",{attrs:{action:e.base_api+"/info_screen/overstock/excel/handler",multiple:"",limit:1,"on-success":e.handleSuccess,headers:e.headers}},[i("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("批量新增 (excel)")])],1)],1),i("el-table",{staticClass:"table-content",staticStyle:{width:"100%"},attrs:{data:e.overstocks,border:!0,stripe:""}},[i("el-table-column",{attrs:{prop:"overstockId",label:"ID",width:"100",align:"center"}}),i("el-table-column",{attrs:{prop:"product",label:"product",width:"300",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("FilterHeader",{attrs:{column:t.column,"field-name":"product","filter-type":"text"},on:{tableFilter:e.tableFilter,resetFilter:e.tableFilterReset}})]}},{key:"default",fn:function(t){return[t.row.overstockId==e.currentUpdateId?i("el-input",{model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}}):i("div",[e._v(e._s(t.row.product))])]}}])}),i("el-table-column",{attrs:{prop:"quantity",label:"quantity",width:"300",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("FilterHeader",{attrs:{column:t.column,"field-name":"quantity","filter-type":"number"},on:{tableFilter:e.tableFilter,resetFilter:e.tableFilterReset}})]}},{key:"default",fn:function(t){return[t.row.overstockId==e.currentUpdateId?i("el-input",{model:{value:e.form.quantity,callback:function(t){e.$set(e.form,"quantity",t)},expression:"form.quantity"}}):i("div",[e._v(e._s(t.row.quantity))])]}}])}),i("el-table-column",{attrs:{prop:"unitPrice",label:"unitPrice",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.overstockId==e.currentUpdateId?i("el-input",{model:{value:e.form.unitPrice,callback:function(t){e.$set(e.form,"unitPrice",t)},expression:"form.unitPrice"}}):i("div",[e._v(e._s(t.row.unitPrice))])]}}])}),i("el-table-column",{attrs:{prop:"totalPrice",label:"totalPrice",width:"200",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("FilterHeader",{attrs:{column:t.column,"field-name":"totalPrice","filter-type":"number"},on:{tableFilter:e.tableFilter,resetFilter:e.tableFilterReset}})]}}])}),i("el-table-column",{attrs:{label:"operation",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.overstockId==e.currentUpdateId?i("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[i("div",[i("el-button",{attrs:{type:"success",round:"",size:"mini"},on:{click:e.confirmUpdate}},[e._v("confirm")])],1),i("div",[i("el-button",{attrs:{type:"warning",round:"",size:"mini"},on:{click:e.cancelUpdate}},[e._v("cancel")])],1)]):i("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[i("div",[i("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(i){return e.update(t.row)}}},[e._v("update")])],1),i("div",[i("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(i){return e.deleteOverstock(t.row.overstockId)}}},[e._v("delete")])],1)])]}}])})],1),i("div",{staticClass:"block",staticStyle:{margin:"20px auto"}},[i("el-pagination",{staticStyle:{float:"right","margin-bottom":"20px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.page.pageNum,total:e.page.total,"page-size":e.page.pageSize},on:{"update:currentPage":function(t){return e.$set(e.page,"pageNum",t)},"update:current-page":function(t){return e.$set(e.page,"pageNum",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e.tableVisable?i("div",{staticClass:"table"},[i("el-card",{staticClass:"table-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("excel data")]),i("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"primary"},on:{click:e.submitToBatch}},[e._v("确认批量操作")])],1),i("el-table",{staticClass:"table-content",staticStyle:{width:"60%",margin:"0 auto"},attrs:{data:e.excelData,border:!0}},[i("el-table-column",{attrs:{prop:"product",label:"product",width:"250",align:"center"}}),i("el-table-column",{attrs:{prop:"quantity",label:"quantity",width:"250",align:"center"}}),i("el-table-column",{attrs:{prop:"unitPrice",label:"unitPrice",align:"center"}})],1)],1)],1):e._e(),i("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.visible,width:"35%"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[i("el-form",{attrs:{model:e.form,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"product:"}},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}})],1),i("el-form-item",{attrs:{label:"quantity:"}},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.form.quantity,callback:function(t){e.$set(e.form,"quantity",t)},expression:"form.quantity"}})],1),i("el-form-item",{attrs:{label:"unitPrice:"}},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.form.unitPrice,callback:function(t){e.$set(e.form,"unitPrice",t)},expression:"form.unitPrice"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitAddForm()}}},[e._v("confirm")])],1)],1)],1)],1)},n=[],a=(i("14d9"),i("4e7b")),r=i("4360"),s=i("d2c2"),l={name:"data-overstock",data(){return{base_api:"https://api.board.ifi-cloud.com",overstocks:[],conditionsFields:[],form:{},currentUpdateId:0,addForm:{},products:[],excelData:[],tableVisable:!1,headers:{token:r["a"].getters.token},page:{pageSize:10,pageNum:1,total:1e3,queryCondition:{product:"",quantityMin:"",quantityMax:"",totalPriceMin:"",totalPriceMax:""}},dialog:{title:"",visible:!1}}},created(){this.getOverstocks(),this.getProducts()},components:{FilterHeader:s["a"]},methods:{async getOverstocks(){const{data:e}=await Object(a["e"])(this.page);console.log(e),200==e.code&&(this.overstocks=e.data.data,this.page.total=e.data.total)},openDialog(e){1==e?(this.form={},this.dialog.title="Add Overstock"):(this.dialog.title="Update Overstock",this.form={}),this.dialog.visible=!this.visible},submit(){console.log(this.form)},update(e){this.form=e,this.currentUpdateId=e.overstockId},async deleteOverstock(e){const{data:t}=await Object(a["c"])(e);200==t.code?(this.$message({type:"success",message:"Delete overstock successfully!"}),this.getOverstocks()):this.$message({type:"warning",message:"Delete overstock project fail!"})},cancelUpdate(){this.currentUpdateId=0,this.form={}},async confirmUpdate(){console.log(this.form);const{data:e}=await Object(a["f"])(this.form);200==e.code?(this.$message({type:"success",message:"Update overstock successfully!"}),this.getOverstocks(),this.currentUpdateId=0,this.form={}):this.$message({type:"warning",message:"Update overstock project fail!"})},async submitAddForm(){console.log(this.form);const{data:e}=await Object(a["a"])(this.form);200==e.code?(this.$message({type:"success",message:"Add overstock successfully!"}),this.getOverstocks(),this.form={},this.dialog.visible=!1):this.$message({type:"warning",message:e.msg})},async submitToBatch(){console.log(this.excelData);const{data:e}=await Object(a["b"])(this.excelData);200==e.code&&(this.tableVisable=!1,this.getOverstocks())},handleSuccess(e){200==e.code&&(this.tableVisable=!0,this.excelData=e.data)},async getProducts(){console.log("get products");const{data:e}=await Object(a["d"])();200==e.code&&(this.products=e.data)},querySearch(e,t){console.log(e),t(this.products)},handleCurrentChange(e){this.page.pageNum=e,this.getOverstocks()},handleSizeChange(e){this.page.pageSize=e,this.getOverstocks()},tableFilter(e,t){let i=!0;t||(this.conditionsFields.forEach(t=>{t.fieldName===e.fieldName&&(t.conditions=e.conditions,i=!1)}),i&&this.conditionsFields.push(e)),this.conditionsFields.filter((e,t)=>{console.log(t),"text"===e.filterType&&""!==e.conditions.text?this.page.queryCondition[e.fieldName]=e.conditions.text:"radio"===e.filterType&&""!==e.conditions.radio?this.page.queryCondition[e.fieldName]=e.conditions.radio:"date"===e.filterType&&(e.conditions.date1||e.conditions.date2)?(this.page.queryCondition.startTime=e.conditions.date1,this.page.queryCondition.endTime=e.conditions.date2):"number"===e.filterType&&(e.conditions.number1||e.conditions.number2)&&("quantity"===e.fieldName&&(this.page.queryCondition.quantityMin=e.conditions.number1,this.page.queryCondition.quantityMax=e.conditions.number2),"totalPrice"===e.fieldName&&(this.page.queryCondition.totalPriceMin=e.conditions.number1,this.page.queryCondition.totalPriceMax=e.conditions.number2))}),this.getOverstocks()},tableFilterReset(e){this.conditionsFields.forEach((t,i)=>{t.fieldName===e.fieldName&&("handlerDate"==t.fieldName&&(this.page.queryCondition.startTime="",this.page.queryCondition.endTime=""),"quantity"==t.fieldName&&(this.page.queryCondition.quantityMin="",this.page.queryCondition.quantityMax=""),"totalPrice"==t.fieldName&&(this.page.queryCondition.totalPriceMin="",this.page.queryCondition.totalPriceMax=""),this.page.queryCondition[t.fieldName]=null,this.conditionsFields.splice(i,1))}),0===this.conditionsFields.length?this.getOverstocks():this.tableFilter(e,!0)}}},c=l,d=(i("7b85"),i("2877")),u=Object(d["a"])(c,o,n,!1,null,"798c8040",null);t["default"]=u.exports}}]);